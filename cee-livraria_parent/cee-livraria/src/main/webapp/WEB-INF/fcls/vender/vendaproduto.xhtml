<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" 
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core" 
	xmlns:p="http://primefaces.prime.com.tr/ui" 
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:plcf="http://www.powerlogic.com.br/plcf" 
	xmlns:tr="http://myfaces.apache.org/trinidad" 
	xmlns:trh="http://myfaces.apache.org/trinidad/html">  
	<ui:composition template="/fcls/template/PlcGeralTemplate.xhtml"> 
		<ui:define name="plc-corpo-formulario"> 
			<div id="plc-corpo-formulario" class="plc-corpo-formulario plc-form-tabular"> 
				<fieldset class="plc-fieldset"> 
					<legend class="plc-fieldset-legend">#{msg['vendaproduto.titulo']}</legend>  
					<plcf:iteracao var="vendaproduto" id="vendaproduto" value="#{vendaprodutoLista.itensPlc}" columnClasses="celulaFormulario" headerClass="celulaFormulario"> 
						<h:column> 
							<h:outputText value="#{rowCounter.index}."/>
						</h:column>  
						<h:column rendered="#{empty requestScope.visualizaDocumentoPlc}"> 
							<f:facet name="header">
								<plcf:tituloExclusao>Exc.</plcf:tituloExclusao>
							</f:facet>  
							<span class="celulaFormularioCaixaMarcacao">
								<plcf:caixaExclusao id="indExcPlc" value="#{vendaproduto.indExcPlc}"/>
							</span> 
						</h:column>  
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.produto']}"/>
							</f:facet>
							<plcf:vinculado id="produto" value="#{vendaproduto.produto}" 
								propSelPop="produto" idExibe="S" 
								idTamanho="12" lookupTamanho="60"
								larg="1200" alt="800"
								autoRecuperacaoPropriedade="codigoBarras"
								autoComplete="true" evento="y"
								idSomenteLeitura="N" autoRecuperacaoClasse="com.cee.livraria.entity.produto.Produto" 
								actionSel="produtosel" modal="S" ajudaChave="ajuda.venda.produto" 
								onkeydown="selecionaPorTecla(event,this);" />
						</h:column>  
						<!-- 
								riaUsa="autocomplete(url='/cee-livraria/soa/service/autocomplete.livro?q=titulo')"/> 
						 -->
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.quantidade']}"/>
							</f:facet>
							<!-- 
							<plcf:numerico id="quantidade" value="#{vendaproduto.quantidade}" numCasas="0" onfocus="formataVlUnitario(#{rowCounter.indexIteration})" tamanho="5" ajudaChave="ajuda.quantidade"/> 
							 -->
							<h:inputText id="quantidade" size="5" value="#{vendaproduto.quantidade}" required="false">
							<f:convertNumber 
							    groupingUsed="true"
							    minIntegerDigits="1"
							    maxIntegerDigits="3"/>
							</h:inputText>							
						</h:column>  
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.tipoProduto']}"/>
							</f:facet>
							<!-- 
							<plcf:exibe id="tipoProduto" rendered="#{vendaproduto.produto != null}" value="#{vendaproduto.tipoProduto}" ajudaChave="ajuda.tipoProduto"/> 
							 -->  
							<h:inputText id="tipoProduto" rendered="#{vendaproduto.produto != null}" size="10" value="#{vendaproduto.tipoProduto.name}" readonly="true" required="false"/>
							<h:inputText id="tipoProduto2" rendered="#{vendaproduto.produto == null}" size="10" value="#{vendaproduto.tipoProduto}" readonly="true" required="false"/>
						</h:column>  
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.nomeTabela']}"/>
							</f:facet>
							<!-- 
							<plcf:exibe id="nomeTabela" rendered="#{vendaproduto.produto != null}" value="#{vendaproduto.nomeTabela}" ajudaChave="ajuda.nomeTabela"/> 
							 -->
							<h:inputText id="nomeTabela" rendered="#{vendaproduto.produto != null}" size="15" value="#{vendaproduto.nomeTabela}" readonly="true" required="false"/>
							<plcf:texto id="nomeTabela2" rendered="#{vendaproduto.produto == null}" value="#{vendaproduto.nomeTabela}" somenteLeitura="S" tamanho="15" ajudaChave="ajuda.nomeTabela"/> 
						</h:column>  
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.valorUnitario']}"/>
							</f:facet>  
							<h:inputText id="valorUnitario" rendered="#{vendaproduto.produto != null}" size="6" value="#{vendaproduto.valorUnitario}" readonly="true" required="false">
							<f:convertNumber maxFractionDigits="2"
							    groupingUsed="true"
							    pattern="#0.00"
							    currencySymbol="R$"
							    minFractionDigits="2"
							    maxIntegerDigits="5"
							    type="currency"/>
							</h:inputText>							
							<!-- 
							<plcf:exibe id="valorUnitario" rendered="#{vendaproduto.produto != null}" value="#{vendaproduto.valorUnitario}" ajudaChave="ajuda.valorUnitario"/>
							 --> 
							<plcf:numerico id="valorUnitario2" rendered="#{vendaproduto.produto == null}" value="#{vendaproduto.valorUnitario}" somenteLeitura="S" tamanho="6" ajudaChave="ajuda.valorUnitario"/> 
						</h:column>  
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.valorTotal']}"/>
							</f:facet>  
							<!-- 
							<plcf:exibe id="valorTotal" rendered="#{vendaproduto.produto != null}" value="#{vendaproduto.valorTotal}" ajudaChave="ajuda.valorTotal"/> 
							 -->
							<h:inputText id="valorTotal" rendered="#{vendaproduto.produto != null}" size="6" value="#{vendaproduto.valorTotal}" readonly="true" required="false">
							<f:convertNumber maxFractionDigits="2"
							    groupingUsed="true"
							    pattern="#0.00"
							    currencySymbol="R$"
							    minFractionDigits="2"
							    maxIntegerDigits="5"
							    type="currency"/>
							</h:inputText>							
							<plcf:numerico id="valorTotal2" rendered="#{vendaproduto.produto == null}" value="#{vendaproduto.valorTotal}" tamanho="6" somenteLeitura="S" ajudaChave="ajuda.valorTotal"/> 
						</h:column> 
					</plcf:iteracao> 
				</fieldset> 
			</div> 
			<div id="plc-corpo-formulario2" class="plc-corpo-formulario plc-form-tabular"> 
				<fieldset class="plc-fieldset"> 
					<legend class="plc-fieldset-legend">#{msg['vendaproduto.pagamento']}</legend>  
					<plcf:iteracao var="pagamento" id="pagamento" value="#{pagamentoLista.itens}" columnClasses="celulaFormulario" headerClass="celulaFormulario"> 
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.valorTotalGeral']}"/>  
							</f:facet>  
							<!-- 
							<plcf:numerico id="valorTotalGeral" value="#{pagamento.valor}" tamanho="8" numCasas="2" somenteLeitura="N" ajudaChave="ajuda.valorTotalGeral"/> 
							<plcf:texto id="valorTotalGeral" value="#{pagamento.valor}" tamanho="8" formato="numerico" ajudaChave="ajuda.valorTotalGeral"/> 
							 -->
							<h:inputText id="valorTotalGeral" size="6" value="#{pagamento.valor}"  required="false">
							<f:convertNumber maxFractionDigits="2"
							    groupingUsed="true"
							    pattern="#0.00"
							    currencySymbol="R$"
							    minFractionDigits="2"
							    maxIntegerDigits="5"
							    type="currency"/>
							</h:inputText>							
						</h:column>  
						<h:column> 
							<f:facet name="header">
								<plcf:titulo value="#{msg['label.formaPagLivroGeral']}"/>  
							</f:facet>  
							<plcf:comboDinamico id="formaPagto" value="#{pagamento.formaPagto}" dominio="FormaPagtoEntity" exibeBranco="S" ajudaChave="ajuda.formaPagtoGeral"/> 
						</h:column>  
						<h:column> 
							<plcf:escondido id="automatico" value="#{pagamento.automatico}" /> 
						</h:column>  
					</plcf:iteracao> 
				</fieldset> 
			</div> 
			<script type="text/javascript">//<![CDATA[
			plc.jq(document).ready(function(){
				plc.jq(document).keydown(function(e) {
					if(e.which == 13) {
						plc.jq("#corpo\\:formulario\\:botaoAcaoBuscarDadosVenda").trigger("click");
					}
				});
				plc.jq(document).on("change", "#corpo\\:formulario\\:pagamento\\:0\\:valorTotalGeral", function() {
					plc.jq("#corpo\\:formulario\\:pagamento\\:0\\:automatico").val( false );
				});
			});
			//]]> </script>
		</ui:define> 
	</ui:composition> 
</html>
